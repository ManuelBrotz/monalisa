package ch.brotzilla.monalisa.rendering;

import java.awt.Color;
import java.awt.Graphics2D;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.text.DecimalFormat;
import java.util.Map;

import javax.imageio.ImageIO;

import ch.brotzilla.monalisa.evolution.genes.Gene;
import ch.brotzilla.monalisa.evolution.genes.Genome;
import ch.brotzilla.monalisa.images.Image;
import ch.brotzilla.monalisa.images.ImageType;
import ch.brotzilla.monalisa.utils.MersenneTwister;
import ch.brotzilla.monalisa.utils.TickRate;

import com.google.common.base.Stopwatch;
import com.google.common.collect.Maps;

public class RenderTest {

    private RenderTest() {}
    
    public static final DecimalFormat rf = new DecimalFormat("#,##0.00");
    
    public static final Color Transparent = new Color(0, 0, 0, 0);

    public static final ImageType Type = ImageType.ARGBPre;
    
    public static class Trimmed {
        
        public final int x, y;
        public final int width, height;
        public final BufferedImage image;
        
        public Trimmed(int x, int y, int width, int height, BufferedImage image) {
            this.x = x;
            this.y = y;
            this.width = width;
            this.height = height;
            this.image = image;
        }
        
        public void draw(Graphics2D g) {
            g.drawImage(image, x, y, null);
        }
        
        public void draw(Image target) {
            draw(target.getGraphics());
        }
        
        public BufferedImage untrimmed() {
            final BufferedImage result = Type.createBufferedImage(width, height);
            final Graphics2D g = result.createGraphics();
            g.setBackground(Transparent);
            g.clearRect(0, 0, width, height);
            draw(g);
            return result;
        }

        public static Trimmed trim(Image input) {
            final int w = input.getWidth(), h = input.getHeight();
            final int[] data = input.readData();
            
            int lx = w, rx = 0, ty = h, by = 0;
            for (int y = 0; y < h; y++) {
                for (int x = 0, i = y * w; i < y * w + w; x++, i++) {
                    final int argb = data[i];
                    final int a = (argb >> 24) & 0x000000FF;
                    if (a > 0) {
                        if (x < lx) lx = x;
                        if (x > rx) rx = x;
                        if (y < ty) ty = y;
                        if (y > by) by = y;
                    }
                }
            }
            ++rx; ++by;
            
            final int width = rx - lx, height = by - ty;
            final BufferedImage result = Type.createBufferedImage(width, height);
            final Graphics2D g = result.createGraphics();
            g.setBackground(Transparent);
            g.clearRect(0, 0, width, height);
            g.drawImage(input.getImage(), 0, 0, width, height, lx, ty, rx, by, null);
            result.setAccelerationPriority(1);
            
            return new Trimmed(lx, ty, width, height, result);
        }
    }
    
    public static void main(String[] args) throws IOException {
        
    }

    public static void parrotTests() throws IOException {
        
        final String ParrotJson = "{\"genes\":[{\"x\":[-135,275,506,97],\"y\":[-6,32,223,35],\"color\":[69,248,248,248]},{\"x\":[522,311,166,421,477,480],\"y\":[303,383,138,148,-69,131],\"color\":[244,52,74,100]},{\"x\":[104,-22,-7,97,120,116,132,128,110,128,139,118,82],\"y\":[266,95,339,296,293,284,268,291,291,248,243,274,237],\"color\":[211,62,75,41]},{\"x\":[358,155,737],\"y\":[104,-72,64],\"color\":[211,71,72,36]},{\"x\":[129,-25,165,199,335,354,298],\"y\":[657,175,223,212,218,258,489],\"color\":[169,112,132,63]},{\"x\":[118,548,438,397,329,351,365,66,90,181,135,87,83],\"y\":[292,59,262,188,241,290,361,309,287,233,284,267,180],\"color\":[87,255,255,119]},{\"x\":[315,331,149,93,59,285,225,280,272,304,335,336,342,306,318,334,300,341,324],\"y\":[55,298,181,258,215,88,88,64,41,53,81,46,100,55,52,83,53,33,62],\"color\":[226,7,7,6]},{\"x\":[334,448,570,337,285,369,356,329,341,361,313,305,323,351,349,344,364,366],\"y\":[186,252,148,72,111,209,219,193,218,192,162,205,231,206,231,190,170,160],\"color\":[172,209,239,108]},{\"x\":[302,145,216,297,298,265,311,281,290],\"y\":[193,117,-33,123,174,175,197,147,179],\"color\":[101,255,255,255]},{\"x\":[235,-92,128,264,302,239,239,297,243,219,232,205],\"y\":[32,10,340,114,88,46,68,50,34,28,30,29],\"color\":[235,126,137,112]},{\"x\":[367,210,111,241,241,336,362,396,390],\"y\":[213,240,345,305,270,180,193,230,197],\"color\":[66,255,255,136]},{\"x\":[99,210,345,213],\"y\":[-99,330,60,17],\"color\":[71,255,255,255]},{\"x\":[-82,326,372,129,148,41],\"y\":[47,347,289,162,94,-41],\"color\":[92,206,200,65]},{\"x\":[385,298,215,357,370,355,366,384,388,378,403,391,395,406],\"y\":[278,494,35,195,320,238,253,226,263,262,291,273,322,290],\"color\":[22,5,5,5]},{\"x\":[126,438,-22,-7],\"y\":[256,147,37,90],\"color\":[72,7,6,6]},{\"x\":[526,394,373,593],\"y\":[246,161,66,-124],\"color\":[186,117,109,81]},{\"x\":[243,94,212,-40],\"y\":[189,128,-19,118],\"color\":[87,62,69,43]},{\"x\":[325,89,62,-108,93,147],\"y\":[128,85,145,116,181,142],\"color\":[140,255,255,255]},{\"x\":[117,144,200,261,308,318],\"y\":[194,95,50,49,77,35],\"color\":[175,86,84,92]},{\"x\":[475,440,335,301,416,231,317,299,379],\"y\":[198,386,44,75,144,-45,-16,46,116],\"color\":[147,181,194,142]},{\"x\":[235,207,388,330,292,247,224,237,233,212],\"y\":[277,383,315,203,216,260,275,290,277,333],\"color\":[141,57,45,4]},{\"x\":[352,343,216,146,174,178,209,206,278,327,363,351,348,343,356,353,323,305,327,342],\"y\":[222,349,358,286,257,238,197,226,224,207,175,210,248,209,221,225,181,215,205,211],\"color\":[183,238,184,7]},{\"x\":[10,-116,176,321,261,232,200,176,119],\"y\":[124,74,-202,56,32,27,29,37,68],\"color\":[252,48,56,26]},{\"x\":[182,167,351,274,239,222],\"y\":[42,113,109,42,37,34],\"color\":[169,3,2,2]},{\"x\":[465,260,230,211,215,198,202,173,187,180,176,157,145,180,202,201,325,372,379,446,413,432],\"y\":[103,99,139,199,232,272,151,199,214,233,236,224,178,219,190,198,152,133,115,115,47,32],\"color\":[236,217,212,187]},{\"x\":[205,251,349,509,490],\"y\":[-23,71,190,69,6],\"color\":[201,121,133,77]},{\"x\":[63,54,674,374,229,123],\"y\":[26,161,372,193,31,45],\"color\":[61,28,25,24]},{\"x\":[239,22,103,139,174,215,231,221,228,215,207,204,234,236,238,236],\"y\":[164,220,361,254,193,189,158,153,181,199,182,202,171,178,161,167],\"color\":[202,124,144,94]},{\"x\":[133,153,-151,66,93,136,62,123,134,120],\"y\":[73,216,191,148,89,88,65,80,72,102],\"color\":[199,210,232,180]},{\"x\":[246,9,-12,10,28,16,68,182,195,213,257,317,256,267,239,249,266],\"y\":[283,315,189,85,77,-13,58,114,204,221,273,287,263,308,322,296,291],\"color\":[20,255,255,255]},{\"x\":[174,193,314,242,297,206,174,162,182,145,179,163,198,169,166,191],\"y\":[18,117,97,47,43,17,45,52,12,36,37,23,17,41,-1,35],\"color\":[79,229,224,222]},{\"x\":[201,161,92,251,427,449,444,301],\"y\":[101,66,65,159,232,201,175,134],\"color\":[68,255,255,255]},{\"x\":[366,326,295,317,339,368,348,351,366,352],\"y\":[161,274,83,89,110,157,127,130,156,204],\"color\":[254,196,156,5]},{\"x\":[72,325,311,51,-33,46,114,75],\"y\":[179,25,-82,116,113,162,140,181],\"color\":[43,255,255,229]},{\"x\":[420,176,65,312,282,403,321,430,526,391,473,436,378,351,395,406],\"y\":[111,-12,109,195,87,139,64,121,-14,53,212,117,114,100,106,89],\"color\":[9,255,255,255]},{\"x\":[152,205,153,211,245,245,261,308,291,275,251,178],\"y\":[171,240,343,276,198,218,242,215,204,221,223,185],\"color\":[36,255,255,255]},{\"x\":[282,344,333,251,214,309,289,259,270,284,313],\"y\":[84,178,197,256,189,162,110,90,81,88,118],\"color\":[58,2,2,2]},{\"x\":[99,241,316,391,345,350,261,299,358,265,325,339,206,160,122,110,77],\"y\":[63,43,54,95,-5,68,59,88,73,39,69,67,53,66,68,82,79],\"color\":[54,6,6,7]},{\"x\":[-15,169,95,32,-96,3],\"y\":[215,220,168,167,71,176],\"color\":[155,159,177,129]},{\"x\":[102,132,165],\"y\":[349,283,395],\"color\":[211,38,50,33]},{\"x\":[483,162,133,60,24,-23,-29],\"y\":[-40,39,87,65,12,67,-11],\"color\":[208,59,61,27]},{\"x\":[216,264,227,214,205,155,132,188,163,181,208,268,217,246,214,228,216,220],\"y\":[192,240,143,134,112,77,157,232,161,188,190,173,191,173,194,177,194,183],\"color\":[107,2,2,2]},{\"x\":[107,48,-25,13,82,81,86],\"y\":[178,436,358,181,183,133,136],\"color\":[36,22,25,17]},{\"x\":[332,304,303,334,334,330,328],\"y\":[165,122,213,193,190,176,191],\"color\":[233,40,40,32]},{\"x\":[526,327,328,537],\"y\":[227,46,-2,-14],\"color\":[100,71,66,44]},{\"x\":[52,-125,2,31,60,-103,95,75,64],\"y\":[214,99,135,125,157,91,170,202,204],\"color\":[191,184,207,92]},{\"x\":[463,189,36,-67,-65,210,348,376,393,449],\"y\":[184,224,77,145,172,256,233,205,230,264],\"color\":[30,252,252,11]},{\"x\":[189,481,471,227,262,243,226,200,150,199,203,184,198,191,159,207,239,225,200,164],\"y\":[190,225,373,312,241,231,216,233,346,189,169,179,159,176,183,183,187,213,191,179],\"color\":[21,6,6,5]},{\"x\":[20,40,-72],\"y\":[211,381,362],\"color\":[217,67,84,42]},{\"x\":[357,359,384,442,398,384,377,362,366,352],\"y\":[126,240,358,360,237,209,181,142,94,171],\"color\":[52,115,182,255]},{\"x\":[82,264,135,229],\"y\":[-58,243,154,-96],\"color\":[14,7,7,7]},{\"x\":[233,232,10,116,182,170,228,242,241,213,225,235],\"y\":[219,358,298,285,214,186,188,146,185,184,213,227],\"color\":[42,255,255,255]},{\"x\":[-5,486,-37,130,154,116],\"y\":[267,-2,225,323,239,309],\"color\":[5,25,26,26]},{\"x\":[191,121,217,137,142,180,202,208],\"y\":[256,396,39,114,173,223,205,203],\"color\":[85,6,6,6]},{\"x\":[289,243,253,256,313,254],\"y\":[229,237,302,250,224,331],\"color\":[123,201,159,14]},{\"x\":[409,389,395,379,329,305,281,267,245,200,173,317],\"y\":[-32,48,94,88,81,54,40,34,29,25,36,1],\"color\":[82,5,5,4]},{\"x\":[123,199,135,169,137,113],\"y\":[359,230,294,286,315,332],\"color\":[47,255,255,116]},{\"x\":[49,131,139,94,60,125,92,48,5,9,60,136],\"y\":[150,219,148,142,92,83,105,127,119,145,158,225],\"color\":[177,163,181,138]},{\"x\":[52,167,98,39,-105,17,32,9,56,162,83,41],\"y\":[203,274,334,164,73,-13,113,124,133,97,170,169],\"color\":[22,255,255,255]},{\"x\":[373,429,471,381,438,254,246,222,270,262,239,206,219,248,270,272,311,270],\"y\":[136,123,211,153,116,109,110,104,95,105,99,92,90,94,91,100,93,100],\"color\":[81,255,255,243]},{\"x\":[147,6,20,109,48],\"y\":[326,150,72,281,315],\"color\":[20,241,255,159]},{\"x\":[308,177,392,441,431,515],\"y\":[-182,4,77,-24,123,30],\"color\":[75,63,65,31]},{\"x\":[214,153,141,147,190,128,147,196,170],\"y\":[191,351,298,293,262,282,256,214,248],\"color\":[98,2,2,2]},{\"x\":[68,505,63],\"y\":[71,39,61],\"color\":[249,74,74,51]},{\"x\":[244,304,280,357,293,253,267,238,197,202,235,258],\"y\":[18,54,149,-44,26,-56,35,22,75,57,27,32],\"color\":[38,57,60,30]},{\"x\":[496,424,410,255,145,171,138,175],\"y\":[265,373,250,50,61,36,-22,-17],\"color\":[24,255,255,13]},{\"x\":[114,-64,0,71,299,130,133],\"y\":[326,180,9,213,156,226,265],\"color\":[2,255,255,127]},{\"x\":[460,416,510],\"y\":[127,231,257],\"color\":[32,218,252,82]},{\"x\":[399,683,442,398,396,388],\"y\":[-50,101,163,141,21,49],\"color\":[93,118,107,80]},{\"x\":[288,362,653,356,343],\"y\":[432,168,242,207,311],\"color\":[13,226,226,226]},{\"x\":[-66,196,211,18],\"y\":[-143,-35,29,40],\"color\":[110,50,60,26]},{\"x\":[285,344,506,335,321,358,308,313,298,304,353,304],\"y\":[273,102,-77,281,300,152,209,163,204,240,287,232],\"color\":[11,253,253,138]},{\"x\":[207,195,171,229,219,237,203,198,203,216,202,203,217],\"y\":[217,247,328,286,277,243,210,241,250,224,197,211,216],\"color\":[107,255,229,126]},{\"x\":[312,265,205,194,215,238,220,240,249,276,316,246,345,320,302,303,233,304,316,305],\"y\":[56,33,20,165,133,170,189,182,165,241,146,155,59,30,36,71,44,89,75,70],\"color\":[5,255,255,255]},{\"x\":[91,-32,88,152,103,119],\"y\":[293,384,172,246,247,291],\"color\":[90,125,142,94]},{\"x\":[367,342,358,346,360,363,293,306,340,260,308],\"y\":[391,212,221,132,218,139,70,134,172,265,368],\"color\":[66,220,173,7]},{\"x\":[147,52,-117,167,120,169],\"y\":[61,117,38,-74,10,36],\"color\":[61,24,28,14]},{\"x\":[320,162,248,329,359,263,309,280,418],\"y\":[397,47,177,137,252,160,222,255,402],\"color\":[15,5,5,5]},{\"x\":[392,338,190,139,376,394],\"y\":[19,52,23,65,29,-18],\"color\":[8,255,255,110]},{\"x\":[351,444,511,390,377,254,336,360,359,343,352,339,348,351,349,348,358,375],\"y\":[222,214,153,165,94,26,97,156,177,220,257,229,233,184,238,226,212,191],\"color\":[33,255,255,255]},{\"x\":[-48,1,138,201,126,58,101,105,77,97],\"y\":[198,252,260,218,225,162,174,192,159,188],\"color\":[50,103,120,79]},{\"x\":[61,-43,-53,234,48,156,74,33,48,63,98,109],\"y\":[93,88,34,531,132,-2,191,82,105,95,81,75],\"color\":[15,228,250,156]},{\"x\":[47,-51,42,86,64,52],\"y\":[189,130,96,170,198,201],\"color\":[61,227,254,114]},{\"x\":[451,293,396,391,444,492],\"y\":[-36,85,97,144,160,28],\"color\":[72,88,86,51]},{\"x\":[190,308,353,324,326,329,375,303,363,332,356,331,304,236,212,202,216,198,223,192,203,200],\"y\":[287,521,252,204,193,97,177,206,371,180,201,229,216,262,269,278,260,278,283,285,272,271],\"color\":[51,223,172,7]},{\"x\":[123,170,72,75],\"y\":[73,-17,-62,81],\"color\":[213,43,48,15]},{\"x\":[440,452,396,417,401,440,458,410,396,428],\"y\":[156,-102,-72,34,79,157,162,104,116,155],\"color\":[131,125,109,83]},{\"x\":[234,334,248,330,338,346,284,232,245,174,247,221,197,238,225,128,241,217,252,229,251,223],\"y\":[110,106,54,54,104,183,117,112,110,91,117,128,157,177,121,83,120,142,154,131,144,114],\"color\":[9,11,11,6]},{\"x\":[405,433,361,343,344,343,348,354,379,388,395],\"y\":[250,380,214,246,221,210,214,206,209,217,232],\"color\":[39,162,197,254]},{\"x\":[72,144,151,119,79,68,61,56,60],\"y\":[51,88,49,11,91,102,105,101,98],\"color\":[120,38,42,16]},{\"x\":[476,373,357,362,377,410],\"y\":[162,72,127,156,171,170],\"color\":[97,127,133,67]},{\"x\":[7,67,78,54],\"y\":[199,249,300,308],\"color\":[88,104,122,84]},{\"x\":[306,375,381,289,277,212,233,225,193,182,184,209,244,215,276,322],\"y\":[42,176,109,74,46,27,28,-6,38,44,64,40,53,21,37,64],\"color\":[16,223,255,255]},{\"x\":[402,404,423,450,454],\"y\":[-100,46,115,117,6],\"color\":[103,130,120,91]},{\"x\":[355,200,210,329,438,411,382,359,346,394,357,359,339],\"y\":[117,79,8,65,178,303,204,188,127,143,127,112,114],\"color\":[2,255,255,255]},{\"x\":[262,237,226,185,171,233,253,243,231],\"y\":[252,209,253,206,327,313,271,276,257],\"color\":[17,255,202,19]},{\"x\":[208,223,174,203,201,196,207,220,215],\"y\":[184,297,320,219,206,213,182,205,186],\"color\":[65,254,223,132]},{\"x\":[171,172,186,195,211,206,180,193,180],\"y\":[307,271,225,232,176,214,287,252,284],\"color\":[192,146,108,3]},{\"x\":[205,199,172,194,147,190,157],\"y\":[116,68,62,86,73,101,67],\"color\":[154,203,197,203]},{\"x\":[161,135,271,203,201,183,176],\"y\":[80,133,233,119,110,95,94],\"color\":[100,37,37,36]},{\"x\":[202,339,204,254,172,204,205,237,170,191,178,206,206,223,217,217,212,215,214,201,218,196,193,214,193],\"y\":[89,131,106,48,54,84,108,101,92,63,146,55,88,85,44,84,90,80,73,98,106,76,56,42,40],\"color\":[9,8,8,8]},{\"x\":[18,51,201,84,179],\"y\":[355,225,127,262,310],\"color\":[16,191,219,152]},{\"x\":[242,347,313,298,276,260,223,225,201],\"y\":[34,109,61,50,37,32,25,33,24],\"color\":[27,162,223,255]},{\"x\":[164,484,167,109,163],\"y\":[318,397,107,252,235],\"color\":[2,228,181,36]},{\"x\":[44,315,30],\"y\":[-2,238,1],\"color\":[6,46,55,30]},{\"x\":[475,572,437,438],\"y\":[-130,121,159,32],\"color\":[141,113,103,77]},{\"x\":[115,196,175,100,173,110,127,140],\"y\":[212,225,276,339,259,230,228,194],\"color\":[1,131,145,107]},{\"x\":[322,329,256,288,333,347,307,304,322,312],\"y\":[93,62,29,71,85,117,70,73,87,91],\"color\":[24,105,173,251]},{\"x\":[367,447,255,345,261,273,219,216,233,220,242,210,203,191,142,142,185,319,345],\"y\":[401,187,102,74,28,49,74,86,85,75,49,50,105,57,126,53,62,253,345],\"color\":[1,105,126,131]},{\"x\":[478,366,313,401],\"y\":[241,299,269,187],\"color\":[1,42,48,48]},{\"x\":[149,364,134,78,72,35,62,28],\"y\":[136,210,152,133,77,113,111,135],\"color\":[13,22,22,24]},{\"x\":[160,-46,-21,126,166,293,193,178,177,147,152,168,184,148,199,226,162,95,114,149],\"y\":[65,167,-46,101,46,48,61,127,59,71,66,71,107,49,71,93,58,91,46,65],\"color\":[7,21,25,16]},{\"x\":[170,82,96,76,134,141,160,215,211,209,206,207,197,157,137,154,162,188,177,192,197,188,180,173,217,172],\"y\":[62,103,108,145,152,102,77,58,93,62,67,85,66,60,74,51,61,64,62,79,72,70,65,63,91,63],\"color\":[41,255,255,255]},{\"x\":[42,58,131,55,-152,-5,40,37,68,33],\"y\":[89,110,63,-35,-98,110,89,106,69,104],\"color\":[90,46,56,27]},{\"x\":[38,327,193,392,432,139,88,45],\"y\":[82,124,32,58,6,81,89,111],\"color\":[1,26,26,28]},{\"x\":[368,240,190,270,309,361,359,354,356,377,403],\"y\":[292,467,177,246,217,306,288,264,265,320,365],\"color\":[19,249,206,9]},{\"x\":[409,419,385,404,378,390,413,391,388,407,393],\"y\":[258,329,249,243,205,237,256,277,267,262,274],\"color\":[42,172,212,252]},{\"x\":[203,176,186,197,200,211,205,189,198,242],\"y\":[123,174,174,166,145,128,121,131,124,118],\"color\":[249,17,16,12]},{\"x\":[246,285,201,323,346,280,256],\"y\":[227,132,142,-80,173,233,238],\"color\":[1,82,121,167]},{\"x\":[235,319,318,345,329,350,307,345,343,325,336,263,264],\"y\":[299,298,263,189,196,172,102,185,192,190,192,262,269],\"color\":[232,191,148,3]},{\"x\":[-4,352,310,277,263,227,303,37,-74,17,-26,-17],\"y\":[282,135,275,283,241,231,178,293,186,293,311,285],\"color\":[4,7,7,6]},{\"x\":[386,326,302,337,337,379,384,382,388,379],\"y\":[85,76,50,36,-65,21,48,67,89,60],\"color\":[223,65,67,29]},{\"x\":[170,141,136,117,142,169,181,194,183,169,115,155,163,174,182,152,138,138,151,176,175,157,166,167],\"y\":[223,162,129,189,212,206,216,203,225,220,310,223,211,230,219,254,335,292,257,223,231,196,204,228],\"color\":[128,197,216,175]},{\"x\":[139,229,342,206,183,168,136,157,133,138,174,147,179,154,146,144,120,144,162],\"y\":[64,130,39,60,86,72,60,78,168,70,56,56,34,55,58,76,98,62,45],\"color\":[9,255,255,255]},{\"x\":[54,31,1,36,59,14],\"y\":[196,167,169,194,198,187],\"color\":[178,193,224,31]},{\"x\":[131,80,183,149,170],\"y\":[198,362,181,167,202],\"color\":[1,133,153,104]},{\"x\":[152,58,-27,9,132,146,134,334,183,165,232,209,158,207,189,144,149,159,153,186,163,150,137,151,167,171,172,188],\"y\":[84,236,132,87,75,84,39,10,63,92,100,122,59,59,56,79,60,62,53,91,68,77,111,83,73,66,77,67],\"color\":[7,255,255,126]},{\"x\":[204,337,251],\"y\":[28,29,-126],\"color\":[211,86,91,39]},{\"x\":[361,258,149,153,113,151,156,150,94,91,179,286,355,363,372],\"y\":[308,268,398,214,238,261,209,237,315,351,207,186,260,196,273],\"color\":[1,144,120,10]},{\"x\":[24,319,120,176,43,-68,138,127,73,82,49,127],\"y\":[344,108,289,263,393,401,203,259,257,289,294,309],\"color\":[4,236,236,236]},{\"x\":[393,410,430,479,426,434,407,408,415,417],\"y\":[225,269,377,226,238,215,207,224,227,236],\"color\":[26,26,26,14]},{\"x\":[415,536,481,397,411,418,416,417,419],\"y\":[293,305,272,230,272,306,261,309,290],\"color\":[242,110,99,74]},{\"x\":[202,97,148,168,186,202,179,185,172,196,189,176,166,198],\"y\":[193,352,236,208,218,196,236,219,192,195,204,184,186,191],\"color\":[104,143,174,210]},{\"x\":[-19,275,166,247,297,279,257,29,31,-62],\"y\":[84,89,92,103,94,86,99,85,105,23],\"color\":[12,7,8,9]},{\"x\":[208,122,165,185,161,198,192,233,202,216,237,225,217,217,207,203,218,212,201,185],\"y\":[207,293,207,218,170,194,212,199,222,236,226,210,227,188,191,203,201,213,210,214],\"color\":[13,200,225,246]},{\"x\":[61,200,202,211,237,199,165,187,168,155,106],\"y\":[443,192,209,175,243,193,180,222,206,222,326],\"color\":[13,179,214,255]},{\"x\":[130,616,472,296,225,195,262,199,162,204],\"y\":[-43,361,274,126,109,98,112,92,50,30],\"color\":[1,67,64,55]},{\"x\":[341,249,322],\"y\":[196,245,119],\"color\":[16,15,13,12]},{\"x\":[415,414,682,430,408,452,410,441],\"y\":[225,379,178,165,171,199,217,215],\"color\":[12,202,219,52]},{\"x\":[20,104,209,22,40,125,55,99,214,255,254],\"y\":[163,222,41,110,275,258,307,328,131,42,-30],\"color\":[2,232,255,190]},{\"x\":[215,79,239,285,342,325,341,213,162,243,224,181,199],\"y\":[184,379,60,36,92,188,209,138,204,192,251,290,238],\"color\":[1,127,126,128]},{\"x\":[102,122,163,140,169,88,45,193,161,115,162],\"y\":[224,84,44,157,273,343,310,244,274,276,228],\"color\":[1,154,154,154]},{\"x\":[22,195,474,257,114],\"y\":[121,87,35,57,100],\"color\":[3,40,39,45]},{\"x\":[323,327,286,276,310,296],\"y\":[194,149,88,86,164,155],\"color\":[29,4,4,4]},{\"x\":[298,378,67,347,262,261,292,314,315],\"y\":[89,120,-9,107,78,59,83,101,101],\"color\":[69,255,255,255]},{\"x\":[203,231,278,232,243],\"y\":[324,156,277,278,308],\"color\":[6,234,184,10]},{\"x\":[321,420,490,314,337,361],\"y\":[67,113,305,110,268,139],\"color\":[1,131,131,18]},{\"x\":[74,20,-73,66,81,57,121,59,3,62],\"y\":[174,152,160,180,199,158,210,145,143,159],\"color\":[35,225,255,98]},{\"x\":[229,203,201,169,268,292,328,269,305,262,250,236,239,232],\"y\":[56,60,75,93,80,92,72,30,93,59,56,60,59,58],\"color\":[13,125,204,255]},{\"x\":[386,440,422,398,502,426,464,414,372,400,370,354,373,368],\"y\":[227,-52,213,288,394,238,80,225,220,246,232,262,273,248],\"color\":[2,255,255,255]},{\"x\":[274,305,333,334,313],\"y\":[32,-68,-50,89,61],\"color\":[62,138,141,70]},{\"x\":[-84,148,202,314],\"y\":[-206,28,9,-145],\"color\":[235,52,59,16]},{\"x\":[96,79,43,16,66],\"y\":[72,33,19,46,101],\"color\":[202,45,54,33]},{\"x\":[361,380,426,432,396,357,426],\"y\":[168,93,128,163,151,169,144],\"color\":[125,127,150,74]},{\"x\":[54,234,311,390,402,354,325,320,340,345],\"y\":[-11,-31,31,-121,98,96,37,75,82,50],\"color\":[16,44,47,19]},{\"x\":[-39,122,201,144,414,151,79],\"y\":[184,187,255,289,389,271,200],\"color\":[1,84,93,71]},{\"x\":[357,418,475,396,360,358,355,370,373,352,365,402,360,375],\"y\":[175,178,212,203,215,250,200,161,177,169,155,171,170,168],\"color\":[28,255,255,255]},{\"x\":[229,259,244,234,216,245,231,244,219,236,246],\"y\":[233,265,235,230,240,219,226,216,241,225,220],\"color\":[119,238,185,5]},{\"x\":[301,258,245,244,264,277,263,298,304,307,307,314],\"y\":[223,239,225,197,222,195,157,178,201,198,207,190],\"color\":[49,105,105,105]},{\"x\":[307,319,293,244,220,226,252,292,272],\"y\":[208,133,169,179,194,216,220,216,222],\"color\":[100,16,15,18]},{\"x\":[403,503,562,359,391,399],\"y\":[100,107,168,183,158,132],\"color\":[8,15,17,10]},{\"x\":[335,305,188,143,226,155,129,280,319],\"y\":[234,167,146,15,151,156,91,38,64],\"color\":[2,188,191,194]},{\"x\":[311,363,262],\"y\":[55,136,37],\"color\":[5,127,157,198]},{\"x\":[455,365,349,415,444,454,429,355,428,466,431,446,473],\"y\":[176,172,196,224,222,206,163,172,169,177,226,178,205],\"color\":[36,229,245,191]},{\"x\":[264,47,26,80,137,136,98,114,203,235,236],\"y\":[102,270,211,82,115,89,76,72,92,104,102],\"color\":[2,255,255,255]},{\"x\":[159,102,184,140,174],\"y\":[214,341,216,208,213],\"color\":[4,158,189,231]},{\"x\":[389,366,336,377,432,385,359,363,379,386,427,414,392,406,396,395],\"y\":[246,381,223,211,234,203,210,195,209,247,275,225,226,258,266,236],\"color\":[10,11,11,11]},{\"x\":[114,324,317,195,124],\"y\":[136,56,71,81,98],\"color\":[1,149,136,128]},{\"x\":[129,276,224],\"y\":[61,47,19],\"color\":[7,255,255,144]},{\"x\":[-17,403,385,178,120,53,3,15,12],\"y\":[118,148,147,129,131,166,159,143,116],\"color\":[13,218,218,226]},{\"x\":[342,319,340,352,345,398,362,353],\"y\":[340,249,223,259,284,407,275,355],\"color\":[37,252,251,11]},{\"x\":[182,114,181,150,216,166,159,172,203,219,217,215,187,183,205,198],\"y\":[173,305,436,264,190,168,179,185,193,253,190,190,177,179,158,173],\"color\":[18,177,212,248]},{\"x\":[390,368,336,362],\"y\":[111,144,99,85],\"color\":[17,227,248,169]},{\"x\":[238,223,271,210,233,140,245,219,206,206,222,230,235,207,241,231,302,257,250,211,210,236,233,229,238,245,296,319,332,323,269,241,246,261,270,250,265,267,252,253],\"y\":[86,117,113,102,117,168,96,99,90,67,100,101,61,103,59,98,91,112,100,80,83,95,82,84,102,102,126,182,145,133,107,79,91,92,86,89,66,73,92,84],\"color\":[22,4,4,4]},{\"x\":[238,250,190],\"y\":[147,321,335],\"color\":[5,255,229,71]},{\"x\":[423,349,408,413,543,513],\"y\":[176,173,104,169,156,267],\"color\":[5,125,136,68]},{\"x\":[386,385,334,382,357,300,339,319,418,489,391,410,427,400,395,387,380,386,362,364],\"y\":[232,183,222,210,202,116,203,193,171,213,224,267,439,249,236,249,210,226,246,249],\"color\":[8,255,255,255]},{\"x\":[-94,55,84,134,120,145,104,96,106,78,54,-65],\"y\":[317,285,293,282,317,281,287,255,275,270,241,143],\"color\":[14,8,9,8]},{\"x\":[336,290,307,326,366,304,286,348,321,344,325,365,345],\"y\":[492,255,201,196,148,75,112,159,153,182,143,178,176],\"color\":[43,221,173,8]},{\"x\":[168,117,172,200,164,140,130,173,167,168,162],\"y\":[206,273,174,188,199,193,247,175,156,200,191],\"color\":[29,214,253,57]},{\"x\":[311,253,337,133,326,306,489,375,408,407,358,319,373,468,376,403,295,288,209,319,276,355,297,368,328,297,222,289,298],\"y\":[105,38,75,-53,50,-24,155,209,225,179,250,215,172,165,137,89,86,108,52,106,109,197,109,134,93,118,110,108,94],\"color\":[4,22,22,22]},{\"x\":[217,199,364,180,196,138,160,119,149,123,109,151],\"y\":[36,109,76,50,-2,18,70,157,43,46,87,32],\"color\":[1,245,245,245]},{\"x\":[32,307,438,426,353,309,350,332,278,333,299,351,281,158,147,57,82,64],\"y\":[367,46,166,86,31,82,125,86,29,68,-93,79,76,220,222,285,287,348],\"color\":[5,9,9,9]},{\"x\":[105,267,258,123,100,164,137,142],\"y\":[128,143,24,49,243,97,124,162],\"color\":[1,231,220,219]},{\"x\":[72,120,271,196,262,494,282,302,194,217,304,304,203],\"y\":[-97,47,84,50,55,165,115,94,99,57,111,97,-12],\"color\":[1,136,136,72]},{\"x\":[281,230,280,292,289,278],\"y\":[97,85,90,99,102,99],\"color\":[166,229,223,216]},{\"x\":[359,352,285,331,332,377,340,346,371],\"y\":[114,200,94,95,108,119,103,108,123],\"color\":[14,252,195,4]},{\"x\":[482,260,232],\"y\":[372,321,219],\"color\":[48,195,154,5]},{\"x\":[106,114,91,18,15,43,78,46,85,62,70],\"y\":[154,175,297,286,175,206,171,119,80,131,128],\"color\":[30,88,100,69]},{\"x\":[149,134,105,127,142,157,187,175,189,219,253,276,282,293,339,318,241,331,294,248,216,193,171,158,155,144,154,145,171],\"y\":[65,95,98,35,72,54,43,58,47,44,51,72,74,84,97,74,38,79,54,58,57,68,63,67,67,63,64,67,40],\"color\":[27,4,4,4]},{\"x\":[127,-83,79,309,317,267,385,281,305,446,241],\"y\":[79,197,111,7,-47,49,-48,51,61,-41,31],\"color\":[3,255,255,255]},{\"x\":[207,208,307,331,237,137,140,177,158,179,176,212,215,204],\"y\":[123,58,54,86,76,155,98,57,88,106,173,91,119,99],\"color\":[3,94,126,136]},{\"x\":[235,270,298,235,209,254,231,251,205,203,199,171,189,204,208,211,182,124,186,221,143,150,193,174,245,178,166,181,188,193,180,196,218],\"y\":[83,83,94,104,95,75,91,100,92,102,92,73,94,85,71,83,88,69,94,131,106,90,93,72,46,54,102,53,85,95,95,90,86],\"color\":[17,5,5,5]},{\"x\":[107,87,99,96],\"y\":[247,178,174,283],\"color\":[209,134,156,102]},{\"x\":[113,97,98,16],\"y\":[24,182,294,259],\"color\":[4,88,104,68]},{\"x\":[294,357,354,337,297,290],\"y\":[90,191,138,109,118,116],\"color\":[103,212,167,6]},{\"x\":[194,186,279],\"y\":[118,151,79],\"color\":[7,14,14,18]},{\"x\":[136,424,91,151],\"y\":[66,39,87,74],\"color\":[1,159,159,171]},{\"x\":[111,55,28,-106,-152],\"y\":[225,238,207,219,133],\"color\":[97,142,166,104]},{\"x\":[147,109,98,-35],\"y\":[96,-106,-305,158],\"color\":[3,39,45,31]},{\"x\":[86,98,136,144,122,138,138,156,126,97,70,58,76,75,82,158,110,94,68,72,64,53],\"y\":[114,141,137,127,135,142,151,201,211,153,137,139,168,121,108,91,85,119,109,109,117,119],\"color\":[58,188,206,168]},{\"x\":[90,91,235,394,273],\"y\":[-28,49,32,266,152],\"color\":[1,119,114,103]},{\"x\":[391,203,163,241,346,404],\"y\":[349,-26,-43,147,238,227],\"color\":[1,56,52,46]},{\"x\":[258,267,232,115,170,232,241,228,223,253,276,280],\"y\":[47,112,116,-21,40,32,50,48,79,48,74,45],\"color\":[1,61,60,41]},{\"x\":[147,204,282,216,138,148,132,142,145,149,142,148,149,148,144,142],\"y\":[56,16,-21,-6,32,58,80,82,57,58,86,47,63,66,53,75],\"color\":[114,68,69,29]},{\"x\":[206,210,483,254,126,240,231,177,198],\"y\":[50,231,258,63,48,48,31,39,85],\"color\":[1,35,35,35]},{\"x\":[278,146,81,79],\"y\":[268,284,271,278],\"color\":[1,232,233,221]},{\"x\":[30,-6,33,54,51,71,99,126,51,121,150,83,110,89,83,68,72,101,78],\"y\":[88,108,123,151,136,141,95,95,119,70,89,104,89,97,109,112,97,81,108],\"color\":[24,151,176,58]},{\"x\":[251,324,165,165],\"y\":[139,91,232,228],\"color\":[11,36,34,24]},{\"x\":[316,257,238,273,282,302,310,297,333,306,304,330,302,306,323,321,298],\"y\":[140,106,123,109,114,118,153,130,151,124,126,155,143,128,161,146,148],\"color\":[46,7,7,7]},{\"x\":[289,236,148,201,154,244,256],\"y\":[163,277,289,202,120,177,146],\"color\":[1,129,102,11]},{\"x\":[508,426,344,429,463,385,393],\"y\":[195,254,181,213,167,144,186],\"color\":[9,233,246,91]},{\"x\":[330,304,241,214,320,234,330,228,342,352,317,255,343,326,334,301,344,306,347,332,325,356,288,355,320,335,327,342,303],\"y\":[166,218,242,192,151,96,130,77,117,129,55,56,112,120,147,120,134,117,126,117,137,166,151,158,144,151,191,173,144],\"color\":[10,11,11,11]},{\"x\":[106,521,131,132],\"y\":[254,149,228,235],\"color\":[2,31,28,22]},{\"x\":[98,367,154,101,39,57],\"y\":[230,25,72,196,231,237],\"color\":[1,125,123,130]},{\"x\":[185,295,120,176,178,188,234,200,229,180,200,161],\"y\":[140,83,116,137,169,160,239,146,123,148,154,108],\"color\":[1,255,255,255]},{\"x\":[349,191,210,324,278,334,328],\"y\":[24,160,58,57,50,28,-85],\"color\":[1,141,141,141]},{\"x\":[205,201,251,244,203,204,207,188,211,210,218,305,284,213,273,262],\"y\":[119,113,153,168,112,83,86,89,91,99,119,152,117,109,155,132],\"color\":[99,194,199,206]},{\"x\":[286,205,198,249,269,208,207,134,156,197,151,138,7,108,119,140],\"y\":[57,51,87,115,78,57,79,26,65,23,45,125,202,89,59,-8],\"color\":[1,218,218,122]},{\"x\":[273,337,306,232,278,282,295,262,260,276,292,292,264,248,277,287],\"y\":[54,93,52,22,51,70,90,84,57,73,73,70,50,52,57,76],\"color\":[20,148,232,255]},{\"x\":[323,151,148,139,59,228,270,267,393,336,321,335],\"y\":[46,19,78,119,87,51,57,-15,25,49,-2,27],\"color\":[1,175,177,123]},{\"x\":[211,268,330,296,300,309,233,252,294,297,284,283,275],\"y\":[108,149,166,235,250,223,225,239,230,220,233,139,215],\"color\":[11,5,5,5]},{\"x\":[183,238,269,256,266],\"y\":[34,189,64,56,25],\"color\":[1,145,143,151]},{\"x\":[350,245,118],\"y\":[-128,125,-7],\"color\":[1,135,140,64]},{\"x\":[257,207,227,244,269,291,296,305,293,284,296,282,297,298,297,264,292,271,260,261],\"y\":[113,130,142,131,161,147,132,141,166,167,159,173,131,120,125,114,123,114,114,113],\"color\":[86,205,209,221]},{\"x\":[456,329,401,650,414],\"y\":[180,73,243,103,264],\"color\":[1,125,148,74]},{\"x\":[371,144,204,230,265,284,314,329],\"y\":[91,-111,28,26,33,41,61,84],\"color\":[48,85,87,39]},{\"x\":[27,153,120,62,-20,79,2,29,17,15,63,43],\"y\":[238,84,68,104,33,44,96,88,77,199,262,284],\"color\":[3,244,244,120]},{\"x\":[226,190,273,419],\"y\":[-52,19,34,130],\"color\":[15,82,85,41]},{\"x\":[236,274,232,269,181,181,258,200],\"y\":[196,36,26,-102,72,26,98,28],\"color\":[1,159,159,159]},{\"x\":[406,381,360,380,374,411],\"y\":[292,212,221,266,322,346],\"color\":[104,60,98,136]},{\"x\":[161,139,-211,127,238,329,320,179,263,305,263,261,203,210,200,150,86],\"y\":[-13,118,108,80,-6,76,-243,23,39,96,55,112,94,44,73,43,-37],\"color\":[1,172,172,108]},{\"x\":[9,224,344,282,305,245,313,451,339,312,270,81,153,271],\"y\":[507,156,169,103,92,47,75,286,98,58,34,384,226,40],\"color\":[2,182,184,197]},{\"x\":[311,319,344,340,257,150,237,234,242,228,234,219,205,206,197,221,199,223,220,243,261,227,290,303,328,316,339],\"y\":[196,217,182,162,120,186,175,156,165,144,172,134,140,145,169,176,155,144,134,153,172,142,181,197,204,193,223],\"color\":[11,7,7,7]},{\"x\":[512,431,755],\"y\":[-207,153,226],\"color\":[144,103,99,72]},{\"x\":[224,267,156,233,271,219,200,218,240,227,221,199,237,262,201,269,194,221,181,217,217,219,222,206,207,211,221,227,208,224,229,232,229,229,226,225],\"y\":[88,68,39,104,99,98,71,38,54,91,49,91,122,111,102,80,98,97,95,93,65,47,95,71,56,65,96,96,77,89,78,58,60,72,83,78],\"color\":[4,23,23,25]},{\"x\":[297,83,233,302,287,299,264,290,326,320,313,252,307,287,281,296,263,294,294],\"y\":[105,13,78,117,95,94,81,99,112,115,105,96,102,110,104,107,157,111,103],\"color\":[26,9,9,10]},{\"x\":[326,421,452,366,375,336,329,318,277,307,328,350,375],\"y\":[77,94,172,119,101,94,81,66,31,20,78,75,83],\"color\":[27,125,130,70]},{\"x\":[323,339,354,352,358,327,315,272,305,318,332,322],\"y\":[250,174,395,280,299,249,269,245,248,237,269,289],\"color\":[33,237,189,9]},{\"x\":[421,484,526,432,436,456],\"y\":[230,220,277,239,227,226],\"color\":[170,179,192,21]},{\"x\":[54,218,-8],\"y\":[37,107,10],\"color\":[172,40,46,26]},{\"x\":[245,267,306,268,246,224,203,199,218,249,259,245,247,245],\"y\":[110,108,123,114,114,109,101,95,103,110,110,109,56,103],\"color\":[67,5,5,5]},{\"x\":[198,244,284,224,206,205,200,149,197,201,159,203,200,220,198,206],\"y\":[92,106,92,28,67,105,44,54,69,64,80,78,106,106,86,72],\"color\":[1,18,17,16]},{\"x\":[150,150,63,103,51,-12,88,101,131,138,120,119,132],\"y\":[210,152,100,214,203,221,223,297,273,251,241,226,228],\"color\":[16,164,179,145]},{\"x\":[419,281,243,270,260,224,355,373,411,435,443],\"y\":[201,222,167,178,150,146,187,177,208,216,214],\"color\":[2,99,80,9]},{\"x\":[217,293,348,269,248,215,205,176,135,210,144,195,227,187,102,179,185,94,182,188,202,228,241,206,216,245,261,265,227],\"y\":[205,296,107,192,166,233,194,185,121,188,243,223,166,226,136,203,275,220,232,216,205,195,187,183,190,227,176,171,200],\"color\":[3,36,36,31]},{\"x\":[139,354,458,291,195,116],\"y\":[26,259,250,119,58,-32],\"color\":[2,20,20,20]},{\"x\":[202,176,320,208,204,232,212,208,199,205,201,180,191,181,193,200,249,208,216,225,196],\"y\":[229,303,349,296,269,237,239,197,201,208,229,234,235,232,231,229,242,232,226,240,226],\"color\":[112,255,240,143]},{\"x\":[201,175,133,365,259,266,234,192,222,195,200,182],\"y\":[95,34,9,75,62,100,104,87,26,99,57,24],\"color\":[1,49,49,15]},{\"x\":[310,333,349,351,351,351,352,351,346],\"y\":[248,228,242,253,261,267,226,263,268],\"color\":[174,207,159,5]},{\"x\":[117,93,126,194,186,144,130,123,122,114],\"y\":[227,227,170,210,224,180,138,144,194,185],\"color\":[5,8,9,7]},{\"x\":[279,328,262,327,364,348,375,285,283,343,351,413,458,391,378,365,356,391,400,383,377,346,376,294,305],\"y\":[255,184,194,234,192,244,234,250,226,230,130,191,185,62,181,183,135,170,170,137,193,267,357,253,269],\"color\":[6,239,239,20]},{\"x\":[176,182,40,17,46,27,145,180,205,167,144,176,113],\"y\":[277,230,161,188,426,147,278,260,222,306,289,272,318],\"color\":[1,4,4,4]},{\"x\":[339,532,409],\"y\":[207,257,105],\"color\":[2,182,196,144]},{\"x\":[207,262,299,360,318,397,290,148,359,276],\"y\":[208,255,295,191,123,56,113,242,76,151],\"color\":[2,44,44,43]},{\"x\":[362,389,360,346,372,360,386,372],\"y\":[214,259,423,261,248,222,218,214],\"color\":[13,7,7,8]},{\"x\":[199,132,15,136,164,195,160,139,177,183,192,218,200,223,223,228,213,198,220,218],\"y\":[195,324,370,258,208,220,193,35,193,187,191,191,234,232,191,237,204,191,196,199],\"color\":[8,171,202,241]},{\"x\":[11,-250,107,48,81,14,-91,5],\"y\":[192,105,175,210,266,201,326,247],\"color\":[9,222,246,96]},{\"x\":[93,340,304,239,123,104,76,49],\"y\":[195,9,45,48,159,196,179,214],\"color\":[1,63,60,60]},{\"x\":[165,12,60,68,111,135],\"y\":[-52,94,148,92,91,109],\"color\":[3,37,43,26]},{\"x\":[170,120,179,158,182,154,137,148,137,147,150,169,167],\"y\":[180,-8,214,183,180,185,124,182,132,172,177,182,162],\"color\":[181,36,37,38]},{\"x\":[282,261,275,285,292,280,281],\"y\":[168,178,146,178,159,155,178],\"color\":[40,164,152,130]},{\"x\":[467,225,180,324],\"y\":[62,54,96,65],\"color\":[1,79,115,148]},{\"x\":[349,363,368,358,356,348,346,352,341,347,357,323,329,332],\"y\":[203,327,315,266,217,215,258,211,213,183,205,186,187,190],\"color\":[25,240,188,14]},{\"x\":[324,346,342,354,327,320,306,317,314,320],\"y\":[215,167,284,244,230,238,207,202,226,233],\"color\":[22,255,212,5]},{\"x\":[351,287,348,336,161,442,334,433,420,363,399,343,378,309,351],\"y\":[265,255,122,91,-124,-55,73,98,-252,177,212,207,252,206,243],\"color\":[3,216,216,39]},{\"x\":[47,-30,-78],\"y\":[169,180,107],\"color\":[108,208,231,88]},{\"x\":[80,64,89,78,52,36,4,15,46,64,91,84,101,93,126],\"y\":[101,130,145,146,138,107,112,89,84,101,105,100,88,82,79],\"color\":[23,115,132,27]},{\"x\":[-43,218,370,109,16,1],\"y\":[250,153,124,141,198,243],\"color\":[2,12,12,12]},{\"x\":[295,257,322],\"y\":[54,93,61],\"color\":[7,79,114,147]},{\"x\":[232,6,259,267,214,199,232,263],\"y\":[117,-147,61,102,101,99,112,131],\"color\":[1,15,18,12]},{\"x\":[137,105,232,325,339,309,279,170,122],\"y\":[252,362,111,207,94,57,42,219,240],\"color\":[2,56,55,64]},{\"x\":[134,272,319,244,213,112,102,-30,110,76,84,111,171,178,169,124,164,137,136,135],\"y\":[139,34,63,175,133,242,157,216,175,125,110,150,124,169,203,162,41,180,144,175],\"color\":[2,184,186,197]},{\"x\":[298,305,367,351,351,337,324,318],\"y\":[226,201,231,238,182,288,194,208],\"color\":[7,255,255,16]},{\"x\":[10,50,68,20,38,13],\"y\":[94,93,117,120,109,109],\"color\":[25,121,143,35]},{\"x\":[399,426,377,389,377,388],\"y\":[238,322,256,264,209,217],\"color\":[8,134,184,253]},{\"x\":[337,332,349,396,358,386,367,368,259,334,350,324,263,357,344,289,341,323,330,364,411,331,332,315,306,351,316,343,360],\"y\":[178,-62,78,84,167,209,209,285,135,268,285,204,604,245,215,196,196,181,217,136,104,178,161,196,183,186,137,182,204],\"color\":[4,248,248,31]},{\"x\":[268,313,219,272,309,248,275,252],\"y\":[156,45,58,240,208,160,171,185],\"color\":[2,190,186,198]},{\"x\":[-79,-152,106],\"y\":[105,295,183],\"color\":[6,185,209,86]},{\"x\":[1,30,79,12,-1],\"y\":[212,211,313,228,264],\"color\":[37,91,113,68]},{\"x\":[156,193,277,54,140,174,135,146,74,125,279,174,184,165],\"y\":[63,64,47,-28,31,91,110,69,90,105,91,74,95,70],\"color\":[2,97,102,60]},{\"x\":[-24,24,-26,56],\"y\":[226,137,36,121],\"color\":[3,191,217,86]},{\"x\":[296,289,150,321,298,285,351,350,337,317,393,360,360,303,319,311,285,321,293,316,287,294,307,292,328,342],\"y\":[91,77,-21,85,86,62,122,213,211,171,209,209,148,135,95,132,112,115,123,102,102,94,95,108,117,135],\"color\":[5,238,189,24]},{\"x\":[391,384,423,456],\"y\":[341,212,292,327],\"color\":[6,144,90,255]},{\"x\":[320,300,216,293,314,318,325,296,304,316,299],\"y\":[141,214,201,179,135,141,144,128,141,142,150],\"color\":[172,32,33,28]},{\"x\":[299,428,610],\"y\":[497,276,394],\"color\":[83,146,136,96]},{\"x\":[290,141,169,149,143,147,138,137,141,237,280,272,265,277,298,319,328,281,256,190,269,291,302,293,284,310,292,295,292,268,260,289,277,274],\"y\":[168,100,71,157,87,90,156,127,102,142,165,152,142,151,229,182,146,169,138,97,152,169,142,102,122,126,162,144,164,163,165,167,184,194],\"color\":[15,24,24,26]},{\"x\":[158,323,147,169,194,181,162,162,156,165,148,148,163,162,152,176,165,164,161],\"y\":[75,125,94,78,81,70,70,47,64,77,79,86,71,85,77,89,80,82,75],\"color\":[12,7,7,7]},{\"x\":[-26,280,156],\"y\":[16,30,-128],\"color\":[13,12,12,9]},{\"x\":[27,370,69,97,6,56,56],\"y\":[50,63,7,96,60,3,52],\"color\":[2,64,66,29]},{\"x\":[-87,19,24,45,48,62,33,48],\"y\":[422,285,207,250,236,256,250,269],\"color\":[89,86,106,60]},{\"x\":[59,33,22,3,53,29,61,58],\"y\":[256,250,209,316,276,300,263,271],\"color\":[89,81,99,55]},{\"x\":[1,24,77,94,84,41],\"y\":[201,199,245,285,287,233],\"color\":[87,118,138,90]},{\"x\":[263,115,58,288],\"y\":[58,39,31,62],\"color\":[207,33,33,22]},{\"x\":[149,157,-160,25,191,81,121,146,171,186,150,171,165],\"y\":[274,203,64,204,264,267,331,267,237,241,277,279,286],\"color\":[1,126,149,103]},{\"x\":[232,334,283],\"y\":[220,344,328],\"color\":[67,202,159,12]},{\"x\":[42,362,110,86],\"y\":[11,-134,53,9],\"color\":[33,53,56,9]},{\"x\":[359,356,291,226,303,310,323],\"y\":[194,203,268,250,220,201,215],\"color\":[39,193,147,3]},{\"x\":[203,162,247,254,219,179,163],\"y\":[-2,50,107,38,31,39,12],\"color\":[2,122,131,51]},{\"x\":[347,63,170,233,245,293,244,257,272,287,249,294,344,336,309],\"y\":[194,-51,40,32,61,96,50,90,81,88,106,146,130,176,220],\"color\":[1,35,33,33]},{\"x\":[160,304,184,158,202,203,151,140,137,139,143,153],\"y\":[108,82,108,106,130,111,75,105,133,151,133,138],\"color\":[2,63,62,66]},{\"x\":[27,-57,45],\"y\":[51,101,78],\"color\":[142,48,55,41]},{\"x\":[108,190,106],\"y\":[-18,-13,66],\"color\":[33,46,49,9]},{\"x\":[3,48,-203,10],\"y\":[6,106,124,126],\"color\":[3,38,45,30]},{\"x\":[35,315,84,97,48],\"y\":[24,66,32,82,27],\"color\":[40,42,47,19]},{\"x\":[392,425,390,385],\"y\":[-71,110,109,37],\"color\":[37,101,93,65]}],\"fitness\":4.145732480916E7,\"generated\":17794766,\"selected\":99290,\"mutations\":1}";
        final Genome Parrot = Genome.fromJson(ParrotJson);
        final int Width = 451, Height = 301;
        final Image image = new Image(Type, Width, Height), temp = new Image(Type, Width, Height);
        final int Loops = 1000;

        image.getImage().setAccelerationPriority(1);
        
        clear(image);
        Parrot.renderGenes(image.getGraphics());
        ImageIO.write(image.getImage(), "PNG", new File("output/parrot.png"));
        
        final TickRate tickrate = new TickRate(10);
        
        System.out.println("Rendering polygons...");
        final Map<Gene, Trimmed> polygons = Maps.newHashMap();
        for (final Gene gene : Parrot.genes) {
            clear(temp);
            if (!polygons.containsKey(gene)) {
                gene.render(temp.getGraphics());
                polygons.put(gene, Trimmed.trim(temp));
            }
        }
        System.out.println("Done!");
        
        clear(image);
        for (final Gene gene : Parrot.genes) {
            polygons.get(gene).draw(image);
        }
        ImageIO.write(image.getImage(), "PNG", new File("output/parrot-cached.png"));
        
        final Stopwatch w = new Stopwatch();
        
        System.out.println("Rendering genome version...");
        w.start();
        for (int i = 0; i < Loops; i++) {
            clear(image);
            Parrot.renderGenes(image.getGraphics());
            tickrate.tick();
        }
        w.stop();
        System.out.println("Done! Took " + w.elapsedMillis() + " ms @ " + rf.format(tickrate.getTickRate()) + " images/sec");
        
        System.out.println("Rendering cached version...");
        tickrate.reset();
        w.reset().start();
        for (int i = 0; i < Loops; i++) {
            clear(image);
            for (final Gene gene : Parrot.genes) {
                polygons.get(gene).draw(image);
            }
            tickrate.tick();
        }
        w.stop();
        System.out.println("Done! Took " + w.elapsedMillis() + " ms @ " + rf.format(tickrate.getTickRate()) + " images/sec");
    }

    public static void simpleTests() throws IOException {
        
        final int Width = 400, Height = 400;
        final int[][] randomPolygon = randomPolygon(Width, Height, "ILoveU".hashCode());
        final Image image = new Image(Type, Width, Height), cachedPolygon = new Image(Type, Width, Height);
        final Color HalfRed = new Color(255, 0, 0, 127);
        final int Loops = 10000;
        
        clear(cachedPolygon);
        renderPolygon(cachedPolygon, randomPolygon, HalfRed);
        ImageIO.write(cachedPolygon.getImage(), "PNG", new File("./output/test_cached.png"));
        
        final Trimmed trimmed = Trimmed.trim(cachedPolygon);
        ImageIO.write(trimmed.image, "PNG", new File("./output/test_trimmed.png"));
        ImageIO.write(trimmed.untrimmed(), "PNG", new File("./output/test_untrimmed.png"));

        final Stopwatch w = new Stopwatch();
        
        clear(image);
        w.start();
        for (int i = 0; i < Loops; i++) {
            renderPolygon(image, randomPolygon, HalfRed);
        }
        w.stop();
        System.out.println("Time for rendering: " + w.elapsedMillis() + " ms");
        
        clear(image);
        w.reset().start();
        for (int i = 0; i < Loops; i++) {
            draw(image, cachedPolygon.getImage());
        }
        w.stop();
        System.out.println("Time for blitting: " + w.elapsedMillis() + " ms");

        clear(image);
        w.reset().start();
        for (int i = 0; i < Loops; i++) {
            trimmed.draw(image);
        }
        w.stop();
        System.out.println("Time for blitting trimmed: " + w.elapsedMillis() + " ms");
    }
    
    public static int[][] randomPolygon(int width, int height, int seed) {
        final MersenneTwister rng = new MersenneTwister(seed);
        final int length = 3 + rng.nextInt(8);
        final int[] x = new int[length], y = new int[length];
        for (int i = 0; i < length; i++) {
            x[i] = rng.nextInt(width - 100) + 50;
            y[i] = rng.nextInt(height - 100) + 50;
        }
        return new int[][] {x, y};
    }
    
    public static void clear(Image target) {
        target.getGraphics().setBackground(Transparent);
        target.getGraphics().clearRect(0, 0, target.getWidth(), target.getHeight());
    }
    
    public static void renderPolygon(Image target, int[][] polygon, Color color) {
        target.getGraphics().setColor(color);
        target.getGraphics().fillPolygon(polygon[0], polygon[1], polygon[0].length);
    }
    
    public static void draw(Image target, BufferedImage source) {
        target.getGraphics().drawImage(source, 0, 0, null);
    }
}
